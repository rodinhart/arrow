{"version":3,"sources":["visitor/indexof.ts"],"names":[],"mappings":"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","file":"indexof.js","sourcesContent":["// Licensed to the Apache Software Foundation (ASF) under one\r\n// or more contributor license agreements.  See the NOTICE file\r\n// distributed with this work for additional information\r\n// regarding copyright ownership.  The ASF licenses this file\r\n// to you under the Apache License, Version 2.0 (the\r\n// \"License\"); you may not use this file except in compliance\r\n// with the License.  You may obtain a copy of the License at\r\n//\r\n//   http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing,\r\n// software distributed under the License is distributed on an\r\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n// KIND, either express or implied.  See the License for the\r\n// specific language governing permissions and limitations\r\n// under the License.\r\n\r\nimport { Data } from '../data';\r\nimport { Type } from '../enum';\r\nimport { Visitor } from '../visitor';\r\nimport { VectorType } from '../interfaces';\r\nimport { getBool, iterateBits } from '../util/bit';\r\nimport { createElementComparator } from '../util/vector';\r\nimport {\r\n    DataType, Dictionary,\r\n    Bool, Null, Utf8, Binary, Decimal, FixedSizeBinary, List, FixedSizeList, Map_, Struct,\r\n    Float, Float16, Float32, Float64,\r\n    Int, Uint8, Uint16, Uint32, Uint64, Int8, Int16, Int32, Int64,\r\n    Date_, DateDay, DateMillisecond,\r\n    Interval, IntervalDayTime, IntervalYearMonth,\r\n    Time, TimeSecond, TimeMillisecond, TimeMicrosecond, TimeNanosecond,\r\n    Timestamp, TimestampSecond, TimestampMillisecond, TimestampMicrosecond, TimestampNanosecond,\r\n    Union, DenseUnion, SparseUnion,\r\n} from '../type';\r\n\r\n/** @ignore */\r\nexport interface IndexOfVisitor extends Visitor {\r\n    visit<T extends VectorType>  (node: T, value: T['TValue'] | null, index?: number): number;\r\n    visitMany <T extends VectorType>  (nodes: T[], values: (T['TValue'] | null)[], indices: (number | undefined)[]): number[];\r\n    getVisitFn<T extends Type>    (node: T): (vector: VectorType<T>, value: VectorType<T>['TValue'] | null, index?: number) => number;\r\n    getVisitFn<T extends DataType>(node: VectorType<T> | Data<T> | T): (vector: VectorType<T>, value:         T['TValue'] | null, index?: number) => number;\r\n    visitNull                 <T extends Null>                (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitBool                 <T extends Bool>                (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitInt                  <T extends Int>                 (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitInt8                 <T extends Int8>                (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitInt16                <T extends Int16>               (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitInt32                <T extends Int32>               (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitInt64                <T extends Int64>               (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitUint8                <T extends Uint8>               (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitUint16               <T extends Uint16>              (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitUint32               <T extends Uint32>              (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitUint64               <T extends Uint64>              (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitFloat                <T extends Float>               (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitFloat16              <T extends Float16>             (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitFloat32              <T extends Float32>             (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitFloat64              <T extends Float64>             (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitUtf8                 <T extends Utf8>                (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitBinary               <T extends Binary>              (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitFixedSizeBinary      <T extends FixedSizeBinary>     (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitDate                 <T extends Date_>               (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitDateDay              <T extends DateDay>             (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitDateMillisecond      <T extends DateMillisecond>     (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitTimestamp            <T extends Timestamp>           (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitTimestampSecond      <T extends TimestampSecond>     (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitTimestampMillisecond <T extends TimestampMillisecond>(vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitTimestampMicrosecond <T extends TimestampMicrosecond>(vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitTimestampNanosecond  <T extends TimestampNanosecond> (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitTime                 <T extends Time>                (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitTimeSecond           <T extends TimeSecond>          (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitTimeMillisecond      <T extends TimeMillisecond>     (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitTimeMicrosecond      <T extends TimeMicrosecond>     (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitTimeNanosecond       <T extends TimeNanosecond>      (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitDecimal              <T extends Decimal>             (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitList                 <T extends List>                (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitStruct               <T extends Struct>              (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitUnion                <T extends Union>               (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitDenseUnion           <T extends DenseUnion>          (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitSparseUnion          <T extends SparseUnion>         (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitDictionary           <T extends Dictionary>          (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitInterval             <T extends Interval>            (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitIntervalDayTime      <T extends IntervalDayTime>     (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitIntervalYearMonth    <T extends IntervalYearMonth>   (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitFixedSizeList        <T extends FixedSizeList>       (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n    visitMap                  <T extends Map_>                (vector: VectorType<T>, value: T['TValue'] | null, index?: number): number;\r\n}\r\n\r\n/** @ignore */\r\nexport class IndexOfVisitor extends Visitor {}\r\n\r\n/** @ignore */\r\nfunction nullIndexOf(vector: VectorType<Null>, searchElement?: null) {\r\n    // if you're looking for nulls and the vector isn't empty, we've got 'em!\r\n    return searchElement === null && vector.length > 0 ? 0 : -1;\r\n}\r\n\r\n/** @ignore */\r\nfunction indexOfNull<T extends DataType>(vector: VectorType<T>, fromIndex?: number): number {\r\n    const { nullBitmap } = vector.data;\r\n    if (!nullBitmap || vector.nullCount <= 0) {\r\n        return -1;\r\n    }\r\n    let i = 0;\r\n    for (const isValid of iterateBits(nullBitmap, vector.data.offset + (fromIndex || 0), vector.length, nullBitmap, getBool)) {\r\n        if (!isValid) { return i; }\r\n        ++i;\r\n    }\r\n    return -1;\r\n}\r\n\r\n/** @ignore */\r\nfunction indexOfValue<T extends DataType>(vector: VectorType<T>, searchElement?: T['TValue'] | null, fromIndex?: number): number {\r\n    if (searchElement === undefined) { return -1; }\r\n    if (searchElement === null) { return indexOfNull(vector, fromIndex); }\r\n    const compare = createElementComparator(searchElement);\r\n    for (let i = (fromIndex || 0) - 1, n = vector.length; ++i < n;) {\r\n        if (compare(vector.get(i))) {\r\n            return i;\r\n        }\r\n    }\r\n    return -1;\r\n}\r\n\r\n/** @ignore */\r\nfunction indexOfUnion<T extends DataType>(vector: VectorType<T>, searchElement?: T['TValue'] | null, fromIndex?: number): number {\r\n    // Unions are special -- they do have a nullBitmap, but so can their children.\r\n    // If the searchElement is null, we don't know whether it came from the Union's\r\n    // bitmap or one of its childrens'. So we don't interrogate the Union's bitmap,\r\n    // since that will report the wrong index if a child has a null before the Union.\r\n    const compare = createElementComparator(searchElement);\r\n    for (let i = (fromIndex || 0) - 1, n = vector.length; ++i < n;) {\r\n        if (compare(vector.get(i))) {\r\n            return i;\r\n        }\r\n    }\r\n    return -1;\r\n}\r\n\r\nIndexOfVisitor.prototype.visitNull                 =  nullIndexOf;\r\nIndexOfVisitor.prototype.visitBool                 = indexOfValue;\r\nIndexOfVisitor.prototype.visitInt                  = indexOfValue;\r\nIndexOfVisitor.prototype.visitInt8                 = indexOfValue;\r\nIndexOfVisitor.prototype.visitInt16                = indexOfValue;\r\nIndexOfVisitor.prototype.visitInt32                = indexOfValue;\r\nIndexOfVisitor.prototype.visitInt64                = indexOfValue;\r\nIndexOfVisitor.prototype.visitUint8                = indexOfValue;\r\nIndexOfVisitor.prototype.visitUint16               = indexOfValue;\r\nIndexOfVisitor.prototype.visitUint32               = indexOfValue;\r\nIndexOfVisitor.prototype.visitUint64               = indexOfValue;\r\nIndexOfVisitor.prototype.visitFloat                = indexOfValue;\r\nIndexOfVisitor.prototype.visitFloat16              = indexOfValue;\r\nIndexOfVisitor.prototype.visitFloat32              = indexOfValue;\r\nIndexOfVisitor.prototype.visitFloat64              = indexOfValue;\r\nIndexOfVisitor.prototype.visitUtf8                 = indexOfValue;\r\nIndexOfVisitor.prototype.visitBinary               = indexOfValue;\r\nIndexOfVisitor.prototype.visitFixedSizeBinary      = indexOfValue;\r\nIndexOfVisitor.prototype.visitDate                 = indexOfValue;\r\nIndexOfVisitor.prototype.visitDateDay              = indexOfValue;\r\nIndexOfVisitor.prototype.visitDateMillisecond      = indexOfValue;\r\nIndexOfVisitor.prototype.visitTimestamp            = indexOfValue;\r\nIndexOfVisitor.prototype.visitTimestampSecond      = indexOfValue;\r\nIndexOfVisitor.prototype.visitTimestampMillisecond = indexOfValue;\r\nIndexOfVisitor.prototype.visitTimestampMicrosecond = indexOfValue;\r\nIndexOfVisitor.prototype.visitTimestampNanosecond  = indexOfValue;\r\nIndexOfVisitor.prototype.visitTime                 = indexOfValue;\r\nIndexOfVisitor.prototype.visitTimeSecond           = indexOfValue;\r\nIndexOfVisitor.prototype.visitTimeMillisecond      = indexOfValue;\r\nIndexOfVisitor.prototype.visitTimeMicrosecond      = indexOfValue;\r\nIndexOfVisitor.prototype.visitTimeNanosecond       = indexOfValue;\r\nIndexOfVisitor.prototype.visitDecimal              = indexOfValue;\r\nIndexOfVisitor.prototype.visitList                 = indexOfValue;\r\nIndexOfVisitor.prototype.visitStruct               = indexOfValue;\r\nIndexOfVisitor.prototype.visitUnion                = indexOfValue;\r\nIndexOfVisitor.prototype.visitDenseUnion           = indexOfUnion;\r\nIndexOfVisitor.prototype.visitSparseUnion          = indexOfUnion;\r\nIndexOfVisitor.prototype.visitDictionary           = indexOfValue;\r\nIndexOfVisitor.prototype.visitInterval             = indexOfValue;\r\nIndexOfVisitor.prototype.visitIntervalDayTime      = indexOfValue;\r\nIndexOfVisitor.prototype.visitIntervalYearMonth    = indexOfValue;\r\nIndexOfVisitor.prototype.visitFixedSizeList        = indexOfValue;\r\nIndexOfVisitor.prototype.visitMap                  = indexOfValue;\r\n\r\n/** @ignore */\r\nexport const instance = new IndexOfVisitor();\r\n"]}